global
    log stdout format raw local0
    maxconn 5000

defaults
    log     global
    mode    http
    option  httplog
    option  dontlognull
    timeout connect 5s
    timeout client  30s
    timeout server  30s

frontend fe_main
    # Railway will pass PORT; we set a default in Dockerfile
    bind :${PORT}
    mode http
    default_backend be_vad

backend be_vad
    mode http
    balance roundrobin

    option httpchk GET /health
    http-check expect status 200

    # Single backend on internal port 8000
    server vad vad-service-2.railway.internal:8000 check inter 3s rise 2 fall 3
